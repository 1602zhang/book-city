"use strict";define(["jquery","base64","text!../../tpl/read.html","template","text!../../tpl/read2.html"],function(s,e,i,c,t){var n=window.localStorage,a=JSON.parse(n.getItem("index"))||1,o=s(".book-read"),l=s(".book-mask"),r=s(".font_back"),u=s(".menu"),d=null;function m(){n.setItem("index",a),s.ajax({url:"/book/read?page="+a,dataType:"json",success:function(e){var t,n;t=e.jsonp,(n=document.createElement("script")).src=t,window.duokan_fiction_chapter=function(e){var t=JSON.parse(s.base64().decode(e));s(".num").html("<b>"+a+"</b>/"+d.toc.length),document.head.removeChild(n),o.html(""),c(i,t,".book-read")},document.head.appendChild(n)}})}function h(e){size=parseInt(o.css("font-size"))+e,o.css("font-size",size),n.setItem("size",size)}s.ajax({url:"/book/menu",dataType:"json",async:!1,success:function(e){d=e.item}}),m(),o.on("click",function(){l.show()}),l.on("click",function(){s(this).hide()}),s(".dialog").on("click",function(){return c(t,d,".menu ul"),u.addClass("active"),!1}),s(".back").on("click",function(){u.removeClass("active")}),s(".main ").on("click","li",function(){a=s(this).data("id"),m(),s(".dialog").removeClass("active"),s(this).addClass("active").siblings().removeClass("active")}),s(".prev").on("click",function(){return a--,s(".num b").html(a),a<1&&(a=1,s(".num b").html(a)),m(),!1}),s(".next").on("click",function(){return a++,s(".num b").html(a),a>d.length&&(a=d.length,s(".num b").html(a)),m(),!1}),s(".font").on("click",function(){return r.hasClass("active")?(r.removeClass("active"),s(this).removeClass("active")):(r.addClass("active"),s(this).addClass("active")),!1}),s(".night").on("click",function(){return l.hasClass("active")?(l.removeClass("active"),s(this).html("夜间")):(l.addClass("active"),s(this).html("白天")),!1}),o.css("font-size",n.getItem("size")),s(".size .big").on("click",function(){return h(2),!1}),s(".size .small").on("click",function(){return h(-2),!1}),o.css("background",JSON.parse(n.getItem("bg"))),s(".bg span").on("click",function(){var e=s(this).css("background");return o.css("background",e),s(this).addClass("active").siblings().removeClass("active"),n.setItem("bg",JSON.stringify(e)),!1}),s(".download").on("click",function(){return!1})});